# PDF-бот  
*Проект для автоматической обработки PDF-документов и экспорта данных в Excel*  
Ссылка на бот @GPRenewal_bot



---

## **Описание проекта**  
Telegram-бот, который извлекает ключевые данные из PDF-документов (ИНН, наименование юридического лица, дату подписания, исходящий номер) и формирует таблицу в формате Excel.  

### **Цель**  
Автоматизировать обработку гарантийных писем и других официальных документов, сократить время на ручное копирование данных и минимизировать ошибки.  

---

## **Функционал**  

| Функция                  | Описание                                                                 |
|--------------------------|-------------------------------------------------------------------------|
| **Извлечение данных**    | Поиск ИНН, юрлица, даты подписания и исходящего номера через регулярные выражения. |
| **Поддержка PDF-файлов** | Обработка как текстовых PDF, так и сканированных документов (с OCR через Tesseract). |
| **Интеграция с Telegram**| Загрузка файлов через Telegram, мгновенная обработка и отправка Excel-таблицы. |
| **Экспорт в Excel**      | Сохранение данных в таблицу с автоматическим обновлением при добавлении новых файлов. |
| **Ограничения**          | Максимальное количество обрабатываемых файлов — 20 за сессию.             |

---

## **Используемые технологии**  

| Сервис / Библиотека      | Назначение                                                                 |
|--------------------------|-------------------------------------------------------------------------|
| **Python**               | Основной язык программирования.                                           |
| **Telegram Bot API**     | Интеграция с Telegram для приема файлов и отправки результатов.           |
| **pdfplumber**           | Извлечение текста из PDF-документов.                                      |
| **pytesseract**          | OCR для сканированных PDF (требуется установка Tesseract OCR).            |
| **pandas + openpyxl**    | Создание и форматирование Excel-таблиц.                                   |
| **Qwen**                 | Генерация кода и оптимизация регулярных выражений.                        |

---

## **Пример работы бота**  

### **1. Загрузка файла**  
Пользователь отправляет PDF-документ:  
```text  
Гарантийное письмо  
От ООО "Рога и Копыта", ИНН 7701234567  
Исх. № 123-ГП от 15 января 2024 г.  
```  

### **2. Извлеченные данные**  
| Поле              | Значение              |  
|-------------------|-----------------------|  
| ИНН               | 7701234567            |  
| Юрлицо            | ООО "Рога и Копыта"    |  
| Дата подписания   | 15.01.2024            |  
| Исходящий номер    | 123-ГП                |  

### **3. Excel-таблица**  
```csv  
filename,inn,legal_name,date,outgoing_number  
document.pdf,7701234567,"ООО Рога и Копыта",15.01.2024,123-ГП  
```  

---

## **Команды бота**  

| Команда        | Описание                          |  
|----------------|-----------------------------------|  
| `/start`       | Приветственное сообщение.         |  
| `/clear`       | Очистка накопленных данных.       |  
| `/send`        | Отправка Excel-файла с результатами. |  

---

## **Преимущества проекта**  
- **Автоматизация**: обработка 20 файлов за 1 минуту.  
- **Точность**: извлечение данных с помощью регулярных выражений и OCR.  
- **Удобство**: интеграция с Telegram и мгновенный экспорт в Excel.  

---

## **Вывод**  
PDF-бот упрощает работу с официальными документами, экономя время сотрудников и минимизируя ошибки. Его можно адаптировать для других задач: извлечение реквизитов из счетов, обработка резюме и т.д.  

### **Контакты для связи**  
- Telegram: [@your_bot_username](https://t.me/your_bot_username)  
- Email: example@email.com  

---

## **Дополнительные материалы**  
- [Документация Telegram Bot API](https://core.telegram.org/bots/api)  
- [Официальный сайт Tesseract OCR](https://tesseract-ocr.github.io/)
